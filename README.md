# 115CloudDriveSubtitleTools
115CloudDriveSubtitleTools一个115网盘的Tampermonkey脚本，用于为视频播放提供良好的观看体验和字幕体验
# 115Master

115 网盘播放页增强脚本（油猴 / Tampermonkey）。主要提供：画质/色彩增强、进度条预览缩略图、在线字幕（字幕组）等能力。

- 版本：`1.6.1`
- 项目主页：`https://github.com/cbingb666/115master`

## 功能说明

### 播放器增强

- 清晰度选择（HLS 多码率）
- 倍速调节、画中画、全屏
- 音轨切换（存在多音轨时）

### 画质/色彩增强

在播放器控制栏中提供“颜色调整”面板，可调节：

- 亮度、对比度、高光、阴影、饱和度、色温、色调
- 锐化、美白强度、肤色范围
- 禁用 HDR（可选）

### 进度条缩略图预览

- 鼠标悬停进度条显示预览缩略图
- 点击缩略图可跳转到对应时间点
- 支持自动缓冲预览图、设置采样间隔（30/60/120 秒；刷新后生效）

### 在线字幕（字幕组）

在播放器控制栏提供“字幕组(C)”入口（支持快捷键 `C`），支持：

- 站内登录/注册（弹窗）
- 字幕开关（显示/隐藏）
- 多字幕变体切换，付费字幕会显示“👑”
- 卡密充值：兑换后解锁更多付费字幕
- 字幕来源展示：
  - `sub-dog`：后端字幕服务
  - `Built-in`：115 内置字幕
  - `115网盘`：来自 115 网盘的字幕文件
- 记住每个视频的字幕选择偏好（下次打开自动恢复）

### 网盘文件列表增强（首页/文件列表）

- 视频封面预览增强（列表模式下）
- 点击/双击视频文件名：使用 `master` 播放页打开
- 中键点击文件项：用 115 原生播放页打开

## 安装（油猴 / Tampermonkey）

1. 安装浏览器扩展 Tampermonkey
   - Chrome/Edge：在扩展商店搜索并安装 “Tampermonkey”
2. 打开 Tampermonkey 管理面板（Dashboard）
3. 安装脚本
   - 推荐：在管理面板中选择“实用工具（Utilities）”→ “从文件导入（Import from file）”，选择本项目的 `dist/115master.user.js`
   - 或者：将 `dist/115master.user.js` 内容复制到 Tampermonkey 的“添加新脚本”中保存
4. 确认脚本已启用，并在 Tampermonkey 中能看到 `115Master`
5. 打开 115 网盘页面，刷新后脚本自动生效

脚本默认匹配的页面（节选）：

- `https://115.com/?ct*`
- `https://115.com/web/lixian/master/video/*`
- `https://115.com/web/lixian/master/magnet/*`
- `https://f.115.com/storage/netdisk*`

## m3u8嗅探脚本功能说明

本仓库同时提供一个通用的 m3u8 嗅探脚本：`userscript/dog-catch-mobile.user.js`。它会在你浏览网页时自动侦测页面请求中的 `m3u8`（以及部分 `video` 直链），并提供一键跳转到字幕狗播放器的入口。

### 主要功能

- 自动嗅探 `m3u8`：通过监听 `Response.prototype.text()` 与 `XMLHttpRequest` 响应内容，识别以 `#EXTM3U` 开头的播放列表
- 侦测视频直链：定时扫描页面中的 `<video>` 元素，捕获可用的 `http(s)` 视频源
- 自动补链 `playlist.m3u8`：当发现路径以 `/video.m3u8` 结尾时，会额外构造同目录的 `../playlist.m3u8` 并展示（常用于多清晰度的 Master Playlist）
- 右上角浮层列表：展示侦测到的资源类型、路径、时长，并提供“播放(Play)”按钮
- 一键跳转字幕狗播放器：点击“播放(Play)”会打开 `https://player.sub-dog.top/`，并附带 `src/type/title/video` 等参数
- 防跳转（仅 `missav.live`）：首次点击播放器区域时短暂拦截弹窗/跳转，降低广告干扰（按住 `Alt`/`Meta` 可放行）

### 安装方式

在 Tampermonkey 中导入安装 `userscript/dog-catch-mobile.user.js`（和安装其他油猴脚本的方式一致：管理面板 → 添加新脚本/从文件导入）。

注意：该脚本的 `@match` 为 `*://*/*`，默认几乎对所有网站生效；同时已排除 `https://player.sub-dog.top/*` 等页面，避免在播放器页面重复运行。

### 使用说明

1. 打开任意包含 HLS 播放的页面，正常开始播放
2. 当脚本侦测到 `m3u8` 或视频直链后，页面右上角会出现一个圆形计数按钮（数字表示已捕获条目数量）
3. 点击某条记录右侧的“播放(Play)”会在新标签页打开字幕狗播放器进行播放
4. 点击条目中的路径文字会复制完整链接
5. 拖动右上角圆形按钮可以调整位置；单击圆形按钮可折叠/展开列表（位置与折叠状态会保存）

## 脚本使用介绍

### 1) 进入播放页

- 在 115 网盘文件列表中：点击或双击视频文件名，会跳转到 `master` 播放页
- 如果你已在 `master` 播放页：脚本会自动加载增强播放器与控件

### 2) 使用字幕组（在线字幕）

1. 在播放器控制栏点击字幕图标（提示“字幕组(C)”）
2. 未登录时：菜单第一行显示“登录/注册”，点击后在弹窗内完成登录/注册
3. 登录后：菜单会列出可用字幕（含来源与是否付费标识）
4. 选择字幕后即可显示；按 `C` 可快速显示/隐藏字幕
5. 遇到付费字幕（带“👑”）：
   - 点击会弹出“账户升级”弹窗
   - 可点击“前往购买卡密”购买后，在弹窗内输入卡密兑换
   - 也可点击“前往字幕狗”打开字幕站：`https://player.sub-dog.top/`

### 3) 使用缩略图预览

- 将鼠标移动到进度条上方即可显示缩略图预览
- 点击缩略图可直接跳转
- 通过“设置”→“预览图”可调整采样间隔与自动缓冲

### 4) 常用快捷键

- `Space`：播放/暂停
- `←` / `A`：快退 5 秒
- `→` / `D`：快进 5 秒（按住可触发长按快进）
- `↑` / `W`：播放速度增大
- `↓` / `S`：播放速度减小
- `0` - `9`：跳转到 0% - 90% 播放进度
- `-` / `=`：音量减小 / 增大
- `M`：静音/取消静音（部分场景也用于恢复挂起播放）
- `C`：显示/隐藏字幕
- `F`：全屏
- `P`：画中画
- `B`：显示/隐藏播放列表侧栏
- `[` / `L`：向左旋转
- `]` / `R`：向右旋转
- `\`：重置旋转
- `H`：水平翻转
- `J`：垂直翻转

## 常见问题

### 为什么脚本没有生效？

- 确认 Tampermonkey 中脚本已启用
- 确认当前页面 URL 在脚本匹配范围内（见上方“脚本默认匹配的页面”）
- 尝试强制刷新页面（`Ctrl+F5`）

### 为什么开启自动播放没有声音？

浏览器对“自动播放带声音”通常有限制，需要用户手势触发或站点允许。可在脚本设置中关闭自动播放，或先手动点一次播放后再使用自动播放。

